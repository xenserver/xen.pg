diff --git a/tools/include/xen-sys/Linux/privcmd.h b/tools/include/xen-sys/Linux/privcmd.h
index 9531b728f9..a9d378e5b7 100644
--- a/tools/include/xen-sys/Linux/privcmd.h
+++ b/tools/include/xen-sys/Linux/privcmd.h
@@ -95,6 +95,10 @@ typedef struct privcmd_mmap_resource {
 	__u64 addr;
 } privcmd_mmap_resource_t;
 
+typedef struct privcmd_restrict_domid {
+	domid_t domid;
+} privcmd_restrict_domid_t;
+
 /*
  * @cmd: IOCTL_PRIVCMD_HYPERCALL
  * @arg: &privcmd_hypercall_t
@@ -114,5 +118,7 @@ typedef struct privcmd_mmap_resource {
 	_IOC(_IOC_NONE, 'P', 6, sizeof(domid_t))
 #define IOCTL_PRIVCMD_MMAP_RESOURCE				\
 	_IOC(_IOC_NONE, 'P', 7, sizeof(privcmd_mmap_resource_t))
+#define IOCTL_PRIVCMD_RESTRICT_DOMID				\
+	_IOC(_IOC_NONE, 'P', 100, sizeof(privcmd_restrict_domid_t))
 
 #endif /* __LINUX_PUBLIC_PRIVCMD_H__ */
diff --git a/tools/libs/call/core.c b/tools/libs/call/core.c
index 46ca61529e..842e68e7f3 100644
--- a/tools/libs/call/core.c
+++ b/tools/libs/call/core.c
@@ -91,6 +91,11 @@ int xencall_close(xencall_handle *xcall)
     return rc;
 }
 
+int xencall_restrict(xencall_handle *xcall, uint32_t dom)
+{
+    return osdep_xencall_restrict(xcall, dom);
+}
+
 int xencall0(xencall_handle *xcall, unsigned int op)
 {
     privcmd_hypercall_t call = {
diff --git a/tools/libs/call/include/xencall.h b/tools/libs/call/include/xencall.h
index 0d09bc8eae..e52b15e205 100644
--- a/tools/libs/call/include/xencall.h
+++ b/tools/libs/call/include/xencall.h
@@ -73,6 +73,8 @@ xencall_handle *xencall_open(struct xentoollog_logger *logger,
  */
 int xencall_close(xencall_handle *xcall);
 
+int xencall_restrict(xencall_handle *xcall, uint32_t domid);
+
 /*
  * Call hypercalls with varying numbers of arguments.
  *
diff --git a/tools/libs/call/libxencall.map b/tools/libs/call/libxencall.map
index c482195b95..29051f63a0 100644
--- a/tools/libs/call/libxencall.map
+++ b/tools/libs/call/libxencall.map
@@ -2,6 +2,7 @@ VERS_1.0 {
 	global:
 		xencall_open;
 		xencall_close;
+		xencall_restrict;
 
 		xencall0;
 		xencall1;
diff --git a/tools/libs/call/linux.c b/tools/libs/call/linux.c
index d8a6306e04..72b0823c00 100644
--- a/tools/libs/call/linux.c
+++ b/tools/libs/call/linux.c
@@ -80,6 +80,12 @@ int osdep_xencall_close(xencall_handle *xcall)
     return 0;
 }
 
+int osdep_xencall_restrict(xencall_handle *xcall, uint32_t dom)
+{
+    struct privcmd_restrict_domid restrict_domid = { dom };
+    return ioctl(xcall->fd, IOCTL_PRIVCMD_RESTRICT_DOMID, &restrict_domid);
+}
+
 int osdep_hypercall(xencall_handle *xcall, privcmd_hypercall_t *hypercall)
 {
     return ioctl(xcall->fd, IOCTL_PRIVCMD_HYPERCALL, hypercall);
diff --git a/tools/libs/call/private.h b/tools/libs/call/private.h
index 21f992b37e..5eb20e34d1 100644
--- a/tools/libs/call/private.h
+++ b/tools/libs/call/private.h
@@ -52,6 +52,7 @@ struct xencall_handle {
 
 int osdep_xencall_open(xencall_handle *xcall);
 int osdep_xencall_close(xencall_handle *xcall);
+int osdep_xencall_restrict(xencall_handle *xcall, uint32_t dom);
 
 int osdep_hypercall(xencall_handle *xcall, privcmd_hypercall_t *hypercall);
 
diff --git a/tools/libs/foreignmemory/linux.c b/tools/libs/foreignmemory/linux.c
index a6b41b0b7f..0bab8590d7 100644
--- a/tools/libs/foreignmemory/linux.c
+++ b/tools/libs/foreignmemory/linux.c
@@ -274,7 +274,8 @@ int osdep_xenforeignmemory_unmap(xenforeignmemory_handle *fmem,
 int osdep_xenforeignmemory_restrict(xenforeignmemory_handle *fmem,
                                     domid_t domid)
 {
-    return ioctl(fmem->fd, IOCTL_PRIVCMD_RESTRICT, &domid);
+    struct privcmd_restrict_domid restrict_domid = { domid };
+    return ioctl(fmem->fd, IOCTL_PRIVCMD_RESTRICT_DOMID, &restrict_domid);
 }
 
 int osdep_xenforeignmemory_unmap_resource(
diff --git a/tools/libxc/include/xenctrl.h b/tools/libxc/include/xenctrl.h
index c2f0688940..ff3ef355c8 100644
--- a/tools/libxc/include/xenctrl.h
+++ b/tools/libxc/include/xenctrl.h
@@ -183,6 +183,11 @@ enum xc_open_flags {
  */
 int xc_interface_close(xc_interface *xch);
 
+/**
+ * Restrict interface to a given domain
+ */
+int xc_interface_restrict(xc_interface *xch, uint32_t domid);
+
 /*
  * HYPERCALL SAFE MEMORY BUFFER
  *
diff --git a/tools/libxc/xc_private.c b/tools/libxc/xc_private.c
index e6e3d9913c..9907d3abd9 100644
--- a/tools/libxc/xc_private.c
+++ b/tools/libxc/xc_private.c
@@ -104,6 +104,12 @@ int xc_interface_close(xc_interface *xch)
     return rc;
 }
 
+int xc_interface_restrict(xc_interface *xch, uint32_t domid)
+{
+    return xencall_restrict(xch->xcall, domid) ?:
+        xenforeignmemory_restrict(xch->fmem, domid);
+}
+
 static pthread_key_t errbuf_pkey;
 static pthread_once_t errbuf_pkey_once = PTHREAD_ONCE_INIT;
 
