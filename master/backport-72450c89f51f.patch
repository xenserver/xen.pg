From 72450c89f51fd1e86081542c270f7e046b340138 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Roger=20Pau=20Monn=C3=A9?= <roger.pau@citrix.com>
Date: Wed, 14 Feb 2018 11:35:42 +0100
Subject: [PATCH] x86/acpi: process softirqs while printing CPU ACPI data
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Or else the watchdog triggers on boxes with a huge number of CPUs

Reported-by: Simon Crowe <simon.crowe@citrix.com>
Signed-off-by: Roger Pau Monn√© <roger.pau@citrix.com>
Acked-by: Andrew Cooper <andrew.cooper3@citrix.com>
Acked-by: Jan Beulich <jbeulich@suse.com>
master commit: a5579ee79ef8546dd47abe34d73dc9a69a14bbda
master date: 2018-01-24 18:02:14 +0100
---
 xen/arch/x86/acpi/cpu_idle.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/xen/arch/x86/acpi/cpu_idle.c b/xen/arch/x86/acpi/cpu_idle.c
index a21aeeda2d..a381c682bc 100644
--- a/xen/arch/x86/acpi/cpu_idle.c
+++ b/xen/arch/x86/acpi/cpu_idle.c
@@ -331,7 +331,10 @@ static void dump_cx(unsigned char key)
     printk("'%c' pressed -> printing ACPI Cx structures\n", key);
     for_each_online_cpu ( cpu )
         if (processor_powers[cpu])
+        {
             print_acpi_power(cpu, processor_powers[cpu]);
+            process_pending_softirqs();
+        }
 }
 
 static int __init cpu_idle_key_init(void)
-- 
2.14.1

