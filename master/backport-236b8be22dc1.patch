From 236b8be22dc18fd92f1f1e095e9c9d9effa995c0 Mon Sep 17 00:00:00 2001
From: Andrew Cooper <andrew.cooper3@citrix.com>
Date: Wed, 9 May 2018 16:54:32 +0100
Subject: [PATCH] x86/emul: Fix emulator test harness build following the
 backport of ff555d59e8a

Signed-off-by: Andrew Cooper <andrew.cooper3@citrix.com>
---
 tools/tests/x86_emulator/x86_emulate.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/tools/tests/x86_emulator/x86_emulate.c b/tools/tests/x86_emulator/x86_emulate.c
index c12527a50b..64ff8eb4c2 100644
--- a/tools/tests/x86_emulator/x86_emulate.c
+++ b/tools/tests/x86_emulator/x86_emulate.c
@@ -23,6 +23,9 @@ typedef bool bool_t;
 #define BUILD_BUG_ON(cond) ((void)BUILD_BUG_ON_ZERO(cond))
 #endif
 
+#define MASK_EXTR(v, m) (((v) & (m)) / ((m) & -(m)))
+#define MASK_INSR(v, m) (((v) * ((m) & -(m))) & (m))
+
 #define cpu_has_amd_erratum(nr) 0
 
 #define __packed __attribute__((packed))
-- 
2.17.0

