From 050470a6e1d3286d509a6d3cdedad04f10bf8fd0 Mon Sep 17 00:00:00 2001
From: Sergey Dyasli <sergey.dyasli@citrix.com>
Date: Wed, 21 Nov 2018 16:12:45 +0000
Subject: [PATCH] x86/pv: silently discard writes into MSR_AMD64_LS_CFG

Signed-off-by: Sergey Dyasli <sergey.dyasli@citrix.com>
diff --git a/xen/arch/x86/traps.c b/xen/arch/x86/traps.c
index 21bc2fe25e..f6fa5f0d7c 100644
--- a/xen/arch/x86/traps.c
+++ b/xen/arch/x86/traps.c
@@ -2962,6 +2962,10 @@ static int emulate_privileged_op(struct cpu_user_regs *regs)
             /* Not available to PV guests. */
             break;
 
+        case MSR_AMD64_LS_CFG:
+            /* Silently discard the write to avoid gdprintk() spam from below */
+            break;
+
         case MSR_P6_PERFCTR(0)...MSR_P6_PERFCTR(7):
         case MSR_P6_EVNTSEL(0)...MSR_P6_EVNTSEL(3):
         case MSR_CORE_PERF_FIXED_CTR0...MSR_CORE_PERF_FIXED_CTR2:
